-----JOINING TABLES---
SELECT *
FROM ABSENTEEISMWORK A LEFT JOIN compensation B ON A.ID = B.ID
LEFT JOIN REASONS R ON
A.Reason_for_absence = R.Number;


---OPTIMISING QUREY TO BRING BACK COLUMNS
1--- BRING BACK A LIST OF 100 HEALTHIEST INDVIDUALS TO 1000 BOUNUS TO ---

SELECT*
FROM Absenteeismwork
WHERE Social_drinker = 0 AND Social_smoker = 0
AND Body_mass_index < 25 AND 
ABSENTEEISM_TIME_IN_HOURS < (SELECT AVG (ABSENTEEISM_TIME_IN_HOURS)
FROM Absenteeismwork)

----INCREASE FOR NON SMOKERS ---- /BUDGET 983,221 .68/ 1,414.4 PERYEAR 
SELECT COUNT (*) AS NONSMOKERS
FROM Absenteeismwork
WHERE Social_smoker = 0

-----OPTIMIZE THIS QUERY---

SELECT A.ID,
R.REASON,
MONTH_OF_ABSENCE,
BODY_MASS_INDEX,
CASE WHEN Body_mass_index < 18.5 THEN 'UNDERWEIGHT'
     WHEN Body_mass_indeX BETWEEN 18.5 AND 25 THEN 'HEALTHY WEIGHT'
     WHEN Body_mass_index BETWEEN 25 AND 30 THEN 'OVERWEIGHT'
     WHEN Body_mass_index > 18.5 THEN 'UNDERWEIGHT'
	 ELSE 'UNKNOWN' END AS BMI_CATAGORY,

CASE WHEN MONTH_OF_ABSENCE IN (12,1,2) THEN 'WINTER'
     WHEN MONTH_OF_ABSENCE IN (3,4,5) THEN 'SPRING'
	 WHEN MONTH_OF_ABSENCE IN (6,7,8) THEN 'SUMMER'
	 WHEN MONTH_OF_ABSENCE IN (9,10,11) THEN 'FALL'
	 ELSE 'UNKNOWN' END AS SEASON_NAMES,
	 MONTH_OF_ABSENCE,
	 DAY_OF_THE_WEEK,
	 TRANSPORTATION_EXPENSE,
	 Education,
	 Son,
	 Social_drinker,
	 Social_smoker,
	 PET,
	 Disciplinary_failure,
	 Age,
	 Work_load_Average_day,
	 Absenteeism_time_in_hours
FROM ABSENTEEISMWORK A LEFT JOIN compensation B ON A.ID = B.ID
LEFT JOIN REASONS R ON
A.Reason_for_absence = R.Number;


----CHANING ON 
SELECT Comp_hr,
FROM ABSENTEEISMWORK A LEFT JOIN compensation B ON A.ID = B.ID
LEFT JOIN REASONS R ON
A.Reason_for_absence = R.Number;

---FINDING OUT THE HEALTHIEST AND---

SELECT  AVG (ABSENTEEISM_TIME_IN_HOURS)
FROM ABSENTEEISMWORK A LEFT JOIN compensation B ON A.ID = B.ID
LEFT JOIN REASONS R ON
A.Reason_for_absence = R.Number
---WHERE Social_drinker = 0 AND Social_smoker = 0


